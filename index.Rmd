---
title: "Dashboard La Huella que Dejamos"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(dygraphs)
library(leaflet)
library(plotly)
library(readr)
set.seed(123)
```

```{r}
datos <- read_csv("datos.csv")
dia <- seq(as.Date("2020-01-01"), as.Date("2020-12-31"), by = "day")
ozono <- datos$O3
nox <- datos$NOX
Res<- datos$Residencial
trab <- datos$Trabajo
```
# En qué consiste la Propuesta 
La Ciencia de Datos es un área de estudio donde la estadística, las matemáticas y la programación se aprenden en conjunto. Se tuvieron tres sesiones de capacitación a manera de introducción a la carrera donde aprendimos tres esquemas generales de modelado de datos. Estos corresponden a una forma de organizar, clasificar e identificar datos de los modelos conocidos hasta el momento de  Machine Learning o Inteligencia Artificial . 

Es entonces que hablamos del aprendizaje del entrenamiento supervisado donde se conocen variables de salida que se quieren estimar para predecir resultados. Aquí vimos regresión. lineal y la clasificación de datos. Es aquí donde contemplamos la cantidad de los valores, su peso y como este impacta en el modelado de datos para brindar un resultado. 

Los temas visto hasta cierto punto fueron, Regresión Lineal, Clasificación y Clustering, y en base a ellos es que genero la siguiente propuesta: La Huella Que Dejamos. 
Donde voy a abordar el tema de el Medio Ambiente y como este se impacta la mala calidad del aire  y su relación con la movilidad urbana en la huella de carbono.

Por lo que los conocimientos que obtuve, más los conocimientos que ya tenía, plantearé una forma de resolverlo teniendo con una regresión lineal en R tomando en cuenta como valores, la calidad de aire y la movilidad durante el año 2020, donde comenzó la pandemia. 

**Bajo la siguiente hipótesis: A mayor cantidad de gente en su casa: menor cantidad de emisiones atmosféricas (especialmente NOX) y mayor cantidad de generación de O3 troposférico.**

# Datos de O3 y NOx

```{r}
datos <- data.frame(fecha = dia, ozono = ozono, nox = nox, residencial = Res, trabajo = trab )
```

## Column {data-width="650"}

### Ozono

```{r}
dygraph(datos[, c("fecha", "ozono")], main = "Niveles de Ozono") %>%
  dyRangeSelector()
```

## Column {data-width="350"}

### NOx

```{r}
dygraph(datos[, c("fecha", "nox")], main = "Niveles de NOx") %>%
  dyRangeSelector()
```

### Tabla de datos

```{r}
datos %>%
  knitr::kable()
```

# Reporte de movilidad

Este es un gráfico que muestra la permanencia de personas en su casa "residential"

## Column {data-width="350"}

```{r}
dygraph(datos[, c("fecha", "residencial")], main = "Movilidad residencial") %>%
  dyRangeSelector()
```

## Column {data-width="350"}

## Gente que se mueve a su trabajo

```{r}
dygraph(datos[, c("fecha", "trabajo")], main = "Movilidad laboral") %>%
  dyRangeSelector()
```

# Regresión lineal cont

```{r}
dato <- data.frame(ozono = ozono, nox = nox)

dato <- na.omit(dato)

dato[] <- lapply(dato, as.numeric)

```

```{r}
# Ajustar modelo de regresión lineal
fit <- lm(nox ~ ozono, data = dato)
```

## Column {data-width="650"}

Gráfica de regresión

```{r}
# Crear gráfica interactiva con plotly
ggplot(dato, aes(x = nox, y = ozono)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red")
```

## Column {data-width="350"}

Resumen del modelo

```{r}
summary(fit)
```

# Regresión lineal movilidad

```{r}
datos2 <- data.frame(ozono = ozono, nox = nox, residencial = Res )

datos2 <- na.omit(datos2) #borra las filas con datos faltantes

datos2[] <- lapply(datos2, as.numeric)

```

```{r}
# Ajustar modelo de regresión lineal
fit2 <- lm(ozono ~ residencial, data = datos2)
```

## Column {data-width="650"}

Gráfica de regresión

```{r}
# Crear gráfica interactiva con plotly
ggplot(datos2, aes(x = residencial, y = ozono)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red")
```

Resumen del modelo

```{r}
summary(fit2)
```

# Datos de Calidad del aire

El **ozono** (O3) es una molécula compuesta por tres átomos de oxígeno. Es un gas incoloro e inestable que se encuentra en la atmósfera terrestre. A nivel del suelo, el ozono es considerado un contaminante peligroso para la salud humana y el medio ambiente.

Los **óxidos de nitrógeno** (NOx) son un grupo de gases compuestos por óxido nítrico (NO) y dióxido de nitrógeno (NO2). Estos gases son producidos principalmente por la combustión de combustibles fósiles en vehículos y plantas industriales. Los NOx son contaminantes peligrosos para la salud humana y el medio ambiente.

Ubicación de la estación de calidad del aire de la cual se tomaron los datos:

```{r}
# Coordenadas de las estaciones
# Coordenadas de las estaciones
estaciones <- data.frame(
  nombre = c("Las Aguilas", "Atemajac", "Centro"),
  lat = c(20.630983, 20.719626, 20.673844),
  long = c(-103.416735, -103.355412, -103.333243),
  ozono = c(0.02, 0.05, 0.05)
)

# Crear mapa interactivo
m <- leaflet() %>%
  addTiles() %>%
  addMarkers(data = estaciones, ~long, ~lat,
             label = ~nombre,
             labelOptions = labelOptions(noHide = TRUE))
m
```
